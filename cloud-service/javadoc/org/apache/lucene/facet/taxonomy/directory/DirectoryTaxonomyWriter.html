<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (11.0.14) on Mon Dec 05 15:20:33 UTC 2022 -->
<title>DirectoryTaxonomyWriter (The Adobe Experience Manager SDK 2022.11.9850.20221116T162329Z-220900)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2022-12-05">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="DirectoryTaxonomyWriter (The Adobe Experience Manager SDK 2022.11.9850.20221116T162329Z-220900)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":9,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":10,"i12":10,"i13":10,"i14":10,"i15":9};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">org.apache.lucene.facet.taxonomy.directory</a></div>
<h2 title="Class DirectoryTaxonomyWriter" class="title">Class DirectoryTaxonomyWriter</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><code>java.io.Closeable</code>, <code>java.lang.AutoCloseable</code>, <code><a href="../TaxonomyWriter.html" title="interface in org.apache.lucene.facet.taxonomy">TaxonomyWriter</a></code>, <code><a href="../../../index/TwoPhaseCommit.html" title="interface in org.apache.lucene.index">TwoPhaseCommit</a></code></dd>
</dl>
<hr>
<pre>public class <span class="typeNameLabel">DirectoryTaxonomyWriter</span>
extends java.lang.Object
implements <a href="../TaxonomyWriter.html" title="interface in org.apache.lucene.facet.taxonomy">TaxonomyWriter</a></pre>
<div class="block"><a href="../TaxonomyWriter.html" title="interface in org.apache.lucene.facet.taxonomy"><code>TaxonomyWriter</code></a> which uses a <a href="../../../store/Directory.html" title="class in org.apache.lucene.store"><code>Directory</code></a> to store the taxonomy
 information on disk, and keeps an additional in-memory cache of some or all
 categories.
 <p>
 In addition to the permanently-stored information in the <a href="../../../store/Directory.html" title="class in org.apache.lucene.store"><code>Directory</code></a>,
 efficiency dictates that we also keep an in-memory cache of <B>recently
 seen</B> or <B>all</B> categories, so that we do not need to go back to disk
 for every category addition to see which ordinal this category already has,
 if any. A <a href="../writercache/TaxonomyWriterCache.html" title="interface in org.apache.lucene.facet.taxonomy.writercache"><code>TaxonomyWriterCache</code></a> object determines the specific caching
 algorithm used.
 <p>
 This class offers some hooks for extending classes to control the
 <a href="../../../index/IndexWriter.html" title="class in org.apache.lucene.index"><code>IndexWriter</code></a> instance that is used. See <a href="#openIndexWriter(org.apache.lucene.store.Directory,org.apache.lucene.index.IndexWriterConfig)"><code>openIndexWriter(org.apache.lucene.store.Directory, org.apache.lucene.index.IndexWriterConfig)</code></a>.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="DirectoryTaxonomyWriter.DiskOrdinalMap.html" title="class in org.apache.lucene.facet.taxonomy.directory">DirectoryTaxonomyWriter.DiskOrdinalMap</a></span></code></th>
<td class="colLast">
<div class="block"><a href="DirectoryTaxonomyWriter.OrdinalMap.html" title="interface in org.apache.lucene.facet.taxonomy.directory"><code>DirectoryTaxonomyWriter.OrdinalMap</code></a> maintained on file system</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="DirectoryTaxonomyWriter.MemoryOrdinalMap.html" title="class in org.apache.lucene.facet.taxonomy.directory">DirectoryTaxonomyWriter.MemoryOrdinalMap</a></span></code></th>
<td class="colLast">
<div class="block"><a href="DirectoryTaxonomyWriter.OrdinalMap.html" title="interface in org.apache.lucene.facet.taxonomy.directory"><code>DirectoryTaxonomyWriter.OrdinalMap</code></a> maintained in memory</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="DirectoryTaxonomyWriter.OrdinalMap.html" title="interface in org.apache.lucene.facet.taxonomy.directory">DirectoryTaxonomyWriter.OrdinalMap</a></span></code></th>
<td class="colLast">
<div class="block">Mapping from old ordinal to new ordinals, used when merging indexes 
 wit separate taxonomies.</div>
</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- =========== FIELD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Field</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#INDEX_EPOCH">INDEX_EPOCH</a></span></code></th>
<td class="colLast">
<div class="block">Property name of user commit data that contains the index epoch.</div>
</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E(org.apache.lucene.store.Directory)">DirectoryTaxonomyWriter</a></span>&#8203;(<a href="../../../store/Directory.html" title="class in org.apache.lucene.store">Directory</a>&nbsp;d)</code></th>
<td class="colLast">
<div class="block">Create this with <code>OpenMode.CREATE_OR_APPEND</code>.</div>
</td>
</tr>
<tr class="rowColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E(org.apache.lucene.store.Directory,org.apache.lucene.index.IndexWriterConfig.OpenMode)">DirectoryTaxonomyWriter</a></span>&#8203;(<a href="../../../store/Directory.html" title="class in org.apache.lucene.store">Directory</a>&nbsp;directory,
                       <a href="../../../index/IndexWriterConfig.OpenMode.html" title="enum in org.apache.lucene.index">IndexWriterConfig.OpenMode</a>&nbsp;openMode)</code></th>
<td class="colLast">
<div class="block">Creates a new instance with a default cache as defined by
 <a href="#defaultTaxonomyWriterCache()"><code>defaultTaxonomyWriterCache()</code></a>.</div>
</td>
</tr>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E(org.apache.lucene.store.Directory,org.apache.lucene.index.IndexWriterConfig.OpenMode,org.apache.lucene.facet.taxonomy.writercache.TaxonomyWriterCache)">DirectoryTaxonomyWriter</a></span>&#8203;(<a href="../../../store/Directory.html" title="class in org.apache.lucene.store">Directory</a>&nbsp;directory,
                       <a href="../../../index/IndexWriterConfig.OpenMode.html" title="enum in org.apache.lucene.index">IndexWriterConfig.OpenMode</a>&nbsp;openMode,
                       <a href="../writercache/TaxonomyWriterCache.html" title="interface in org.apache.lucene.facet.taxonomy.writercache">TaxonomyWriterCache</a>&nbsp;cache)</code></th>
<td class="colLast">
<div class="block">Construct a Taxonomy writer.</div>
</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ========== METHOD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#addCategory(org.apache.lucene.facet.taxonomy.FacetLabel)">addCategory</a></span>&#8203;(<a href="../FacetLabel.html" title="class in org.apache.lucene.facet.taxonomy">FacetLabel</a>&nbsp;categoryPath)</code></th>
<td class="colLast">
<div class="block">addCategory() adds a category with a given path name to the taxonomy,
 and returns its ordinal.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#addTaxonomy(org.apache.lucene.store.Directory,org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.OrdinalMap)">addTaxonomy</a></span>&#8203;(<a href="../../../store/Directory.html" title="class in org.apache.lucene.store">Directory</a>&nbsp;taxoDir,
           <a href="DirectoryTaxonomyWriter.OrdinalMap.html" title="interface in org.apache.lucene.facet.taxonomy.directory">DirectoryTaxonomyWriter.OrdinalMap</a>&nbsp;map)</code></th>
<td class="colLast">
<div class="block">Takes the categories from the given taxonomy directory, and adds the
 missing ones to this taxonomy.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#close()">close</a></span>()</code></th>
<td class="colLast">
<div class="block">Frees used resources as well as closes the underlying <a href="../../../index/IndexWriter.html" title="class in org.apache.lucene.index"><code>IndexWriter</code></a>,
 which commits whatever changes made to it to the underlying
 <a href="../../../store/Directory.html" title="class in org.apache.lucene.store"><code>Directory</code></a>.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#commit()">commit</a></span>()</code></th>
<td class="colLast">
<div class="block">The second phase of a 2-phase commit.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>static <a href="../writercache/TaxonomyWriterCache.html" title="interface in org.apache.lucene.facet.taxonomy.writercache">TaxonomyWriterCache</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#defaultTaxonomyWriterCache()">defaultTaxonomyWriterCache</a></span>()</code></th>
<td class="colLast">
<div class="block">Defines the default <a href="../writercache/TaxonomyWriterCache.html" title="interface in org.apache.lucene.facet.taxonomy.writercache"><code>TaxonomyWriterCache</code></a> to use in constructors
 which do not specify one.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>java.util.Map&lt;java.lang.String,&#8203;java.lang.String&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getCommitData()">getCommitData</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns the commit user data map that was set on
 <a href="../TaxonomyWriter.html#setCommitData(java.util.Map)"><code>TaxonomyWriter.setCommitData(Map)</code></a>.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code><a href="../../../store/Directory.html" title="class in org.apache.lucene.store">Directory</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getDirectory()">getDirectory</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns the <a href="../../../store/Directory.html" title="class in org.apache.lucene.store"><code>Directory</code></a> of this taxonomy writer.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getParent(int)">getParent</a></span>&#8203;(int&nbsp;ordinal)</code></th>
<td class="colLast">
<div class="block">getParent() returns the ordinal of the parent category of the category
 with the given ordinal.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getSize()">getSize</a></span>()</code></th>
<td class="colLast">
<div class="block">getSize() returns the number of categories in the taxonomy.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getTaxonomyEpoch()">getTaxonomyEpoch</a></span>()</code></th>
<td class="colLast">
<div class="block">Expert: returns current index epoch, if this is a
 near-real-time reader.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareCommit()">prepareCommit</a></span>()</code></th>
<td class="colLast">
<div class="block">prepare most of the work needed for a two-phase commit.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#replaceTaxonomy(org.apache.lucene.store.Directory)">replaceTaxonomy</a></span>&#8203;(<a href="../../../store/Directory.html" title="class in org.apache.lucene.store">Directory</a>&nbsp;taxoDir)</code></th>
<td class="colLast">
<div class="block">Replaces the current taxonomy with the given one.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#rollback()">rollback</a></span>()</code></th>
<td class="colLast">
<div class="block">Rollback changes to the taxonomy writer and closes the instance.</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setCacheMissesUntilFill(int)">setCacheMissesUntilFill</a></span>&#8203;(int&nbsp;i)</code></th>
<td class="colLast">
<div class="block">Set the number of cache misses before an attempt is made to read the entire
 taxonomy into the in-memory cache.</div>
</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setCommitData(java.util.Map)">setCommitData</a></span>&#8203;(java.util.Map&lt;java.lang.String,&#8203;java.lang.String&gt;&nbsp;commitUserData)</code></th>
<td class="colLast">
<div class="block">Sets the commit user data map.</div>
</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code>static void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#unlock(org.apache.lucene.store.Directory)">unlock</a></span>&#8203;(<a href="../../../store/Directory.html" title="class in org.apache.lucene.store">Directory</a>&nbsp;directory)</code></th>
<td class="colLast">
<div class="block">Forcibly unlocks the taxonomy in the named directory.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>equals, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a id="INDEX_EPOCH">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>INDEX_EPOCH</h4>
<pre>public static final&nbsp;java.lang.String INDEX_EPOCH</pre>
<div class="block">Property name of user commit data that contains the index epoch. The epoch
 changes whenever the taxonomy is recreated (i.e. opened with
 <a href="../../../index/IndexWriterConfig.OpenMode.html#CREATE"><code>IndexWriterConfig.OpenMode.CREATE</code></a>.
 <p>
 Applications should not use this property in their commit data because it
 will be overridden by this taxonomy writer.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../constant-values.html#org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.INDEX_EPOCH">Constant Field Values</a></dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a id="&lt;init&gt;(org.apache.lucene.store.Directory,org.apache.lucene.index.IndexWriterConfig.OpenMode,org.apache.lucene.facet.taxonomy.writercache.TaxonomyWriterCache)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DirectoryTaxonomyWriter</h4>
<pre>public&nbsp;DirectoryTaxonomyWriter&#8203;(<a href="../../../store/Directory.html" title="class in org.apache.lucene.store">Directory</a>&nbsp;directory,
                               <a href="../../../index/IndexWriterConfig.OpenMode.html" title="enum in org.apache.lucene.index">IndexWriterConfig.OpenMode</a>&nbsp;openMode,
                               <a href="../writercache/TaxonomyWriterCache.html" title="interface in org.apache.lucene.facet.taxonomy.writercache">TaxonomyWriterCache</a>&nbsp;cache)
                        throws java.io.IOException</pre>
<div class="block">Construct a Taxonomy writer.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>directory</code> - The <a href="../../../store/Directory.html" title="class in org.apache.lucene.store"><code>Directory</code></a> in which to store the taxonomy. Note that
    the taxonomy is written directly to that directory (not to a
    subdirectory of it).</dd>
<dd><code>openMode</code> - Specifies how to open a taxonomy for writing: <code>APPEND</code>
    means open an existing index for append (failing if the index does
    not yet exist). <code>CREATE</code> means create a new index (first
    deleting the old one if it already existed).
    <code>APPEND_OR_CREATE</code> appends to an existing index if there
    is one, otherwise it creates a new index.</dd>
<dd><code>cache</code> - A <a href="../writercache/TaxonomyWriterCache.html" title="interface in org.apache.lucene.facet.taxonomy.writercache"><code>TaxonomyWriterCache</code></a> implementation which determines
    the in-memory caching policy. See for example
    <a href="../writercache/LruTaxonomyWriterCache.html" title="class in org.apache.lucene.facet.taxonomy.writercache"><code>LruTaxonomyWriterCache</code></a> and <a href="../writercache/Cl2oTaxonomyWriterCache.html" title="class in org.apache.lucene.facet.taxonomy.writercache"><code>Cl2oTaxonomyWriterCache</code></a>.
    If null or missing, <a href="#defaultTaxonomyWriterCache()"><code>defaultTaxonomyWriterCache()</code></a> is used.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../index/CorruptIndexException.html" title="class in org.apache.lucene.index">CorruptIndexException</a></code> - if the taxonomy is corrupted.</dd>
<dd><code><a href="../../../store/LockObtainFailedException.html" title="class in org.apache.lucene.store">LockObtainFailedException</a></code> - if the taxonomy is locked by another writer. If it is known
     that no other concurrent writer is active, the lock might
     have been left around by an old dead process, and should be
     removed using <a href="#unlock(org.apache.lucene.store.Directory)"><code>unlock(Directory)</code></a>.</dd>
<dd><code>java.io.IOException</code> - if another error occurred.</dd>
</dl>
</li>
</ul>
<a id="&lt;init&gt;(org.apache.lucene.store.Directory,org.apache.lucene.index.IndexWriterConfig.OpenMode)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DirectoryTaxonomyWriter</h4>
<pre>public&nbsp;DirectoryTaxonomyWriter&#8203;(<a href="../../../store/Directory.html" title="class in org.apache.lucene.store">Directory</a>&nbsp;directory,
                               <a href="../../../index/IndexWriterConfig.OpenMode.html" title="enum in org.apache.lucene.index">IndexWriterConfig.OpenMode</a>&nbsp;openMode)
                        throws java.io.IOException</pre>
<div class="block">Creates a new instance with a default cache as defined by
 <a href="#defaultTaxonomyWriterCache()"><code>defaultTaxonomyWriterCache()</code></a>.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</li>
</ul>
<a id="&lt;init&gt;(org.apache.lucene.store.Directory)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>DirectoryTaxonomyWriter</h4>
<pre>public&nbsp;DirectoryTaxonomyWriter&#8203;(<a href="../../../store/Directory.html" title="class in org.apache.lucene.store">Directory</a>&nbsp;d)
                        throws java.io.IOException</pre>
<div class="block">Create this with <code>OpenMode.CREATE_OR_APPEND</code>.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
<!-- ============ METHOD DETAIL ========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="unlock(org.apache.lucene.store.Directory)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>unlock</h4>
<pre class="methodSignature">public static&nbsp;void&nbsp;unlock&#8203;(<a href="../../../store/Directory.html" title="class in org.apache.lucene.store">Directory</a>&nbsp;directory)
                   throws java.io.IOException</pre>
<div class="block">Forcibly unlocks the taxonomy in the named directory.
 <P>
 Caution: this should only be used by failure recovery code, when it is
 known that no other process nor thread is in fact currently accessing
 this taxonomy.
 <P>
 This method is unnecessary if your <a href="../../../store/Directory.html" title="class in org.apache.lucene.store"><code>Directory</code></a> uses a
 <a href="../../../store/NativeFSLockFactory.html" title="class in org.apache.lucene.store"><code>NativeFSLockFactory</code></a> instead of the default
 <a href="../../../store/SimpleFSLockFactory.html" title="class in org.apache.lucene.store"><code>SimpleFSLockFactory</code></a>. When the "native" lock is used, a lock
 does not stay behind forever when the process using it dies.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</li>
</ul>
<a id="defaultTaxonomyWriterCache()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>defaultTaxonomyWriterCache</h4>
<pre class="methodSignature">public static&nbsp;<a href="../writercache/TaxonomyWriterCache.html" title="interface in org.apache.lucene.facet.taxonomy.writercache">TaxonomyWriterCache</a>&nbsp;defaultTaxonomyWriterCache()</pre>
<div class="block">Defines the default <a href="../writercache/TaxonomyWriterCache.html" title="interface in org.apache.lucene.facet.taxonomy.writercache"><code>TaxonomyWriterCache</code></a> to use in constructors
 which do not specify one.
 <P>  
 The current default is <a href="../writercache/Cl2oTaxonomyWriterCache.html" title="class in org.apache.lucene.facet.taxonomy.writercache"><code>Cl2oTaxonomyWriterCache</code></a> constructed
 with the parameters (1024, 0.15f, 3), i.e., the entire taxonomy is
 cached in memory while building it.</div>
</li>
</ul>
<a id="close()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>close</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;close()
           throws java.io.IOException</pre>
<div class="block">Frees used resources as well as closes the underlying <a href="../../../index/IndexWriter.html" title="class in org.apache.lucene.index"><code>IndexWriter</code></a>,
 which commits whatever changes made to it to the underlying
 <a href="../../../store/Directory.html" title="class in org.apache.lucene.store"><code>Directory</code></a>.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code>close</code>&nbsp;in interface&nbsp;<code>java.lang.AutoCloseable</code></dd>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code>close</code>&nbsp;in interface&nbsp;<code>java.io.Closeable</code></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</li>
</ul>
<a id="addCategory(org.apache.lucene.facet.taxonomy.FacetLabel)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addCategory</h4>
<pre class="methodSignature">public&nbsp;int&nbsp;addCategory&#8203;(<a href="../FacetLabel.html" title="class in org.apache.lucene.facet.taxonomy">FacetLabel</a>&nbsp;categoryPath)
                throws java.io.IOException</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../TaxonomyWriter.html#addCategory(org.apache.lucene.facet.taxonomy.FacetLabel)">TaxonomyWriter</a></code></span></div>
<div class="block">addCategory() adds a category with a given path name to the taxonomy,
 and returns its ordinal. If the category was already present in
 the taxonomy, its existing ordinal is returned.
 <P>
 Before adding a category, addCategory() makes sure that all its
 ancestor categories exist in the taxonomy as well. As result, the
 ordinal of a category is guaranteed to be smaller then the ordinal of
 any of its descendants.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../TaxonomyWriter.html#addCategory(org.apache.lucene.facet.taxonomy.FacetLabel)">addCategory</a></code>&nbsp;in interface&nbsp;<code><a href="../TaxonomyWriter.html" title="interface in org.apache.lucene.facet.taxonomy">TaxonomyWriter</a></code></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</li>
</ul>
<a id="commit()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>commit</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;commit()
            throws java.io.IOException</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../../../index/TwoPhaseCommit.html#commit()">TwoPhaseCommit</a></code></span></div>
<div class="block">The second phase of a 2-phase commit. Implementations should ideally do
 very little work in this method (following <a href="../../../index/TwoPhaseCommit.html#prepareCommit()"><code>TwoPhaseCommit.prepareCommit()</code></a>, and
 after it returns, the caller can assume that the changes were successfully
 committed to the underlying storage.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../index/TwoPhaseCommit.html#commit()">commit</a></code>&nbsp;in interface&nbsp;<code><a href="../../../index/TwoPhaseCommit.html" title="interface in org.apache.lucene.index">TwoPhaseCommit</a></code></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</li>
</ul>
<a id="setCommitData(java.util.Map)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setCommitData</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;setCommitData&#8203;(java.util.Map&lt;java.lang.String,&#8203;java.lang.String&gt;&nbsp;commitUserData)</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../TaxonomyWriter.html#setCommitData(java.util.Map)">TaxonomyWriter</a></code></span></div>
<div class="block">Sets the commit user data map. That method is considered a transaction and
 will be <a href="../../../index/TwoPhaseCommit.html#commit()"><code>committed</code></a> even if no other changes were made to
 the writer instance.
 <p>
 <b>NOTE:</b> the map is cloned internally, therefore altering the map's
 contents after calling this method has no effect.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../TaxonomyWriter.html#setCommitData(java.util.Map)">setCommitData</a></code>&nbsp;in interface&nbsp;<code><a href="../TaxonomyWriter.html" title="interface in org.apache.lucene.facet.taxonomy">TaxonomyWriter</a></code></dd>
</dl>
</li>
</ul>
<a id="getCommitData()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCommitData</h4>
<pre class="methodSignature">public&nbsp;java.util.Map&lt;java.lang.String,&#8203;java.lang.String&gt;&nbsp;getCommitData()</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../TaxonomyWriter.html#getCommitData()">TaxonomyWriter</a></code></span></div>
<div class="block">Returns the commit user data map that was set on
 <a href="../TaxonomyWriter.html#setCommitData(java.util.Map)"><code>TaxonomyWriter.setCommitData(Map)</code></a>.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../TaxonomyWriter.html#getCommitData()">getCommitData</a></code>&nbsp;in interface&nbsp;<code><a href="../TaxonomyWriter.html" title="interface in org.apache.lucene.facet.taxonomy">TaxonomyWriter</a></code></dd>
</dl>
</li>
</ul>
<a id="prepareCommit()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareCommit</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;prepareCommit()
                   throws java.io.IOException</pre>
<div class="block">prepare most of the work needed for a two-phase commit.
 See <a href="../../../index/IndexWriter.html#prepareCommit()"><code>IndexWriter.prepareCommit()</code></a>.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../index/TwoPhaseCommit.html#prepareCommit()">prepareCommit</a></code>&nbsp;in interface&nbsp;<code><a href="../../../index/TwoPhaseCommit.html" title="interface in org.apache.lucene.index">TwoPhaseCommit</a></code></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</li>
</ul>
<a id="getSize()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSize</h4>
<pre class="methodSignature">public&nbsp;int&nbsp;getSize()</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../TaxonomyWriter.html#getSize()">TaxonomyWriter</a></code></span></div>
<div class="block">getSize() returns the number of categories in the taxonomy.
 <P>
 Because categories are numbered consecutively starting with 0, it
 means the taxonomy contains ordinals 0 through getSize()-1.
 <P>
 Note that the number returned by getSize() is often slightly higher
 than the number of categories inserted into the taxonomy; This is
 because when a category is added to the taxonomy, its ancestors
 are also added automatically (including the root, which always get
 ordinal 0).</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../TaxonomyWriter.html#getSize()">getSize</a></code>&nbsp;in interface&nbsp;<code><a href="../TaxonomyWriter.html" title="interface in org.apache.lucene.facet.taxonomy">TaxonomyWriter</a></code></dd>
</dl>
</li>
</ul>
<a id="setCacheMissesUntilFill(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setCacheMissesUntilFill</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;setCacheMissesUntilFill&#8203;(int&nbsp;i)</pre>
<div class="block">Set the number of cache misses before an attempt is made to read the entire
 taxonomy into the in-memory cache.
 <p>
 This taxonomy writer holds an in-memory cache of recently seen categories
 to speed up operation. On each cache-miss, the on-disk index needs to be
 consulted. When an existing taxonomy is opened, a lot of slow disk reads
 like that are needed until the cache is filled, so it is more efficient to
 read the entire taxonomy into memory at once. We do this complete read
 after a certain number (defined by this method) of cache misses.
 <p>
 If the number is set to <code>0</code>, the entire taxonomy is read into the
 cache on first use, without fetching individual categories first.
 <p>
 NOTE: it is assumed that this method is called immediately after the
 taxonomy writer has been created.</div>
</li>
</ul>
<a id="getParent(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getParent</h4>
<pre class="methodSignature">public&nbsp;int&nbsp;getParent&#8203;(int&nbsp;ordinal)
              throws java.io.IOException</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../TaxonomyWriter.html#getParent(int)">TaxonomyWriter</a></code></span></div>
<div class="block">getParent() returns the ordinal of the parent category of the category
 with the given ordinal.
 <P>
 When a category is specified as a path name, finding the path of its
 parent is as trivial as dropping the last component of the path.
 getParent() is functionally equivalent to calling getPath() on the
 given ordinal, dropping the last component of the path, and then calling
 getOrdinal() to get an ordinal back. 
 <P>
 If the given ordinal is the ROOT_ORDINAL, an INVALID_ORDINAL is returned.
 If the given ordinal is a top-level category, the ROOT_ORDINAL is returned.
 If an invalid ordinal is given (negative or beyond the last available
 ordinal), an ArrayIndexOutOfBoundsException is thrown. However, it is
 expected that getParent will only be called for ordinals which are
 already known to be in the taxonomy.
 TODO (Facet): instead of a getParent(ordinal) method, consider having a
 <P>
 getCategory(categorypath, prefixlen) which is similar to addCategory
 except it doesn't add new categories; This method can be used to get
 the ordinals of all prefixes of the given category, and it can use
 exactly the same code and cache used by addCategory() so it means less code.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../TaxonomyWriter.html#getParent(int)">getParent</a></code>&nbsp;in interface&nbsp;<code><a href="../TaxonomyWriter.html" title="interface in org.apache.lucene.facet.taxonomy">TaxonomyWriter</a></code></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</li>
</ul>
<a id="addTaxonomy(org.apache.lucene.store.Directory,org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.OrdinalMap)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addTaxonomy</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;addTaxonomy&#8203;(<a href="../../../store/Directory.html" title="class in org.apache.lucene.store">Directory</a>&nbsp;taxoDir,
                        <a href="DirectoryTaxonomyWriter.OrdinalMap.html" title="interface in org.apache.lucene.facet.taxonomy.directory">DirectoryTaxonomyWriter.OrdinalMap</a>&nbsp;map)
                 throws java.io.IOException</pre>
<div class="block">Takes the categories from the given taxonomy directory, and adds the
 missing ones to this taxonomy. Additionally, it fills the given
 <a href="DirectoryTaxonomyWriter.OrdinalMap.html" title="interface in org.apache.lucene.facet.taxonomy.directory"><code>DirectoryTaxonomyWriter.OrdinalMap</code></a> with a mapping from the original ordinal to the new
 ordinal.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</li>
</ul>
<a id="rollback()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>rollback</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;rollback()
              throws java.io.IOException</pre>
<div class="block">Rollback changes to the taxonomy writer and closes the instance. Following
 this method the instance becomes unusable (calling any of its API methods
 will yield an <a href="../../../store/AlreadyClosedException.html" title="class in org.apache.lucene.store"><code>AlreadyClosedException</code></a>).</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../index/TwoPhaseCommit.html#rollback()">rollback</a></code>&nbsp;in interface&nbsp;<code><a href="../../../index/TwoPhaseCommit.html" title="interface in org.apache.lucene.index">TwoPhaseCommit</a></code></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</li>
</ul>
<a id="replaceTaxonomy(org.apache.lucene.store.Directory)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>replaceTaxonomy</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;replaceTaxonomy&#8203;(<a href="../../../store/Directory.html" title="class in org.apache.lucene.store">Directory</a>&nbsp;taxoDir)
                     throws java.io.IOException</pre>
<div class="block">Replaces the current taxonomy with the given one. This method should
 generally be called in conjunction with
 <a href="../../../index/IndexWriter.html#addIndexes(org.apache.lucene.store.Directory...)"><code>IndexWriter.addIndexes(Directory...)</code></a> to replace both the taxonomy
 as well as the search index content.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</li>
</ul>
<a id="getDirectory()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDirectory</h4>
<pre class="methodSignature">public&nbsp;<a href="../../../store/Directory.html" title="class in org.apache.lucene.store">Directory</a>&nbsp;getDirectory()</pre>
<div class="block">Returns the <a href="../../../store/Directory.html" title="class in org.apache.lucene.store"><code>Directory</code></a> of this taxonomy writer.</div>
</li>
</ul>
<a id="getTaxonomyEpoch()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getTaxonomyEpoch</h4>
<pre class="methodSignature">public final&nbsp;long&nbsp;getTaxonomyEpoch()</pre>
<div class="block">Expert: returns current index epoch, if this is a
 near-real-time reader.  Used by <a href="DirectoryTaxonomyReader.html" title="class in org.apache.lucene.facet.taxonomy.directory"><code>DirectoryTaxonomyReader</code></a> to support NRT.</div>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
<p class="legalCopy"><small>Copyright &copy; 2010 - 2022 Adobe. All Rights Reserved</small></p>
</footer>
</body>
</html>
