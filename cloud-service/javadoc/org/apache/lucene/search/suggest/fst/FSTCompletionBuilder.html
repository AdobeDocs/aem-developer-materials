<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (11.0.12) on Wed Oct 06 16:52:31 UTC 2021 -->
<title>FSTCompletionBuilder (The Adobe Experience Manager SDK 2021.9.5899.20210929T093525Z-210900)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2021-10-06">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="FSTCompletionBuilder (The Adobe Experience Manager SDK 2021.9.5899.20210929T093525Z-210900)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":10,"i1":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">org.apache.lucene.search.suggest.fst</a></div>
<h2 title="Class FSTCompletionBuilder" class="title">Class FSTCompletionBuilder</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>org.apache.lucene.search.suggest.fst.FSTCompletionBuilder</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<pre>public class <span class="typeNameLabel">FSTCompletionBuilder</span>
extends <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a></pre>
<div class="block">Finite state automata based implementation of "autocomplete" functionality.
 
 <h2>Implementation details</h2>
 
 <p>
 The construction step in <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang" class="externalLink"><code>Object.finalize()</code></a> works as follows:
 <ul>
 <li>A set of input terms and their buckets is given.</li>
 <li>All terms in the input are prefixed with a synthetic pseudo-character
 (code) of the weight bucket the term fell into. For example a term
 <code>abc</code> with a discretized weight equal '1' would become
 <code>1abc</code>.</li>
 <li>The terms are then sorted by their raw value of UTF-8 character values
 (including the synthetic bucket code in front).</li>
 <li>A finite state automaton (<a href="../../../util/fst/FST.html" title="class in org.apache.lucene.util.fst"><code>FST</code></a>) is constructed from the input. The
 root node has arcs labeled with all possible weights. We cache all these
 arcs, highest-weight first.</li>
 </ul>
 
 <p>
 At runtime, in <a href="FSTCompletion.html#lookup(java.lang.CharSequence,int)"><code>FSTCompletion.lookup(CharSequence, int)</code></a>, 
 the automaton is utilized as follows:
 <ul>
 <li>For each possible term weight encoded in the automaton (cached arcs from
 the root above), starting with the highest one, we descend along the path of
 the input key. If the key is not a prefix of a sequence in the automaton
 (path ends prematurely), we exit immediately -- no completions.</li>
 <li>Otherwise, we have found an internal automaton node that ends the key.
 <b>The entire subautomaton (all paths) starting from this node form the key's
 completions.</b> We start the traversal of this subautomaton. Every time we
 reach a final state (arc), we add a single suggestion to the list of results
 (the weight of this suggestion is constant and equal to the root path we
 started from). The tricky part is that because automaton edges are sorted and
 we scan depth-first, we can terminate the entire procedure as soon as we
 collect enough suggestions the user requested.</li>
 <li>In case the number of suggestions collected in the step above is still
 insufficient, we proceed to the next (smaller) weight leaving the root node
 and repeat the same algorithm again.</li>
 </ul>
 
 <h2>Runtime behavior and performance characteristic</h2>
 
 The algorithm described above is optimized for finding suggestions to short
 prefixes in a top-weights-first order. This is probably the most common use
 case: it allows presenting suggestions early and sorts them by the global
 frequency (and then alphabetically).
 
 <p>
 If there is an exact match in the automaton, it is returned first on the
 results list (even with by-weight sorting).
 
 <p>
 Note that the maximum lookup time for <b>any prefix</b> is the time of
 descending to the subtree, plus traversal of the subtree up to the number of
 requested suggestions (because they are already presorted by weight on the
 root level and alphabetically at any node level).
 
 <p>
 To order alphabetically only (no ordering by priorities), use identical term
 weights for all terms. Alphabetical suggestions are returned even if
 non-constant weights are used, but the algorithm for doing this is
 suboptimal.
 
 <p>
 "alphabetically" in any of the documentation above indicates UTF-8
 representation order, nothing else.
 
 <p>
 <b>NOTE</b>: the FST file format is experimental and subject to suddenly
 change, requiring you to rebuild the FST suggest index.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="FSTCompletion.html" title="class in org.apache.lucene.search.suggest.fst"><code>FSTCompletion</code></a></dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Field</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#DEFAULT_BUCKETS">DEFAULT_BUCKETS</a></span></code></th>
<td class="colLast">
<div class="block">Default number of buckets.</div>
</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E()">FSTCompletionBuilder</a></span>()</code></th>
<td class="colLast">
<div class="block">Creates an <a href="FSTCompletion.html" title="class in org.apache.lucene.search.suggest.fst"><code>FSTCompletion</code></a> with default options: 10 buckets, exact match
 promoted to first position and <a href="../InMemorySorter.html" title="class in org.apache.lucene.search.suggest"><code>InMemorySorter</code></a> with a comparator obtained from
 <a href="../../../util/BytesRef.html#getUTF8SortedAsUnicodeComparator()"><code>BytesRef.getUTF8SortedAsUnicodeComparator()</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E(int,org.apache.lucene.search.suggest.fst.BytesRefSorter,int)">FSTCompletionBuilder</a></span>&#8203;(int&nbsp;buckets,
                    <a href="BytesRefSorter.html" title="interface in org.apache.lucene.search.suggest.fst">BytesRefSorter</a>&nbsp;sorter,
                    int&nbsp;shareMaxTailLength)</code></th>
<td class="colLast">
<div class="block">Creates an FSTCompletion with the specified options.</div>
</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ========== METHOD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#add(org.apache.lucene.util.BytesRef,int)">add</a></span>&#8203;(<a href="../../../util/BytesRef.html" title="class in org.apache.lucene.util">BytesRef</a>&nbsp;utf8,
   int&nbsp;bucket)</code></th>
<td class="colLast">
<div class="block">Appends a single suggestion and its weight to the internal buffers.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code><a href="FSTCompletion.html" title="class in org.apache.lucene.search.suggest.fst">FSTCompletion</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#build()">build</a></span>()</code></th>
<td class="colLast">
<div class="block">Builds the final automaton from a list of added entries.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang" class="externalLink">equals</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang" class="externalLink">getClass</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang" class="externalLink">hashCode</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang" class="externalLink">notify</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang" class="externalLink">notifyAll</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang" class="externalLink">toString</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang" class="externalLink">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang" class="externalLink">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait(long,int)" title="class or interface in java.lang" class="externalLink">wait</a></code></li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a id="DEFAULT_BUCKETS">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>DEFAULT_BUCKETS</h4>
<pre>public static final&nbsp;int DEFAULT_BUCKETS</pre>
<div class="block">Default number of buckets.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../constant-values.html#org.apache.lucene.search.suggest.fst.FSTCompletionBuilder.DEFAULT_BUCKETS">Constant Field Values</a></dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a id="&lt;init&gt;()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>FSTCompletionBuilder</h4>
<pre>public&nbsp;FSTCompletionBuilder()</pre>
<div class="block">Creates an <a href="FSTCompletion.html" title="class in org.apache.lucene.search.suggest.fst"><code>FSTCompletion</code></a> with default options: 10 buckets, exact match
 promoted to first position and <a href="../InMemorySorter.html" title="class in org.apache.lucene.search.suggest"><code>InMemorySorter</code></a> with a comparator obtained from
 <a href="../../../util/BytesRef.html#getUTF8SortedAsUnicodeComparator()"><code>BytesRef.getUTF8SortedAsUnicodeComparator()</code></a>.</div>
</li>
</ul>
<a id="&lt;init&gt;(int,org.apache.lucene.search.suggest.fst.BytesRefSorter,int)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>FSTCompletionBuilder</h4>
<pre>public&nbsp;FSTCompletionBuilder&#8203;(int&nbsp;buckets,
                            <a href="BytesRefSorter.html" title="interface in org.apache.lucene.search.suggest.fst">BytesRefSorter</a>&nbsp;sorter,
                            int&nbsp;shareMaxTailLength)</pre>
<div class="block">Creates an FSTCompletion with the specified options.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>buckets</code> - The number of buckets for weight discretization. Buckets are used
          in <a href="#add(org.apache.lucene.util.BytesRef,int)"><code>add(BytesRef, int)</code></a> and must be smaller than the number
          given here.</dd>
<dd><code>sorter</code> - <a href="BytesRefSorter.html" title="interface in org.apache.lucene.search.suggest.fst"><code>BytesRefSorter</code></a> used for re-sorting input for the automaton.
          For large inputs, use on-disk sorting implementations. The sorter
          is closed automatically in <a href="#build()"><code>build()</code></a> if it implements
          <a href="https://docs.oracle.com/javase/8/docs/api/java/io/Closeable.html?is-external=true" title="class or interface in java.io" class="externalLink"><code>Closeable</code></a>.</dd>
<dd><code>shareMaxTailLength</code> - Max shared suffix sharing length.
          
          See the description of this parameter in <a href="../../../util/fst/Builder.html" title="class in org.apache.lucene.util.fst"><code>Builder</code></a>'s constructor.
          In general, for very large inputs you'll want to construct a non-minimal
          automaton which will be larger, but the construction will take far less ram.
          For minimal automata, set it to <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Integer.html?is-external=true#MAX_VALUE" title="class or interface in java.lang" class="externalLink"><code>Integer.MAX_VALUE</code></a>.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
<!-- ============ METHOD DETAIL ========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="add(org.apache.lucene.util.BytesRef,int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>add</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;add&#8203;(<a href="../../../util/BytesRef.html" title="class in org.apache.lucene.util">BytesRef</a>&nbsp;utf8,
                int&nbsp;bucket)
         throws <a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></pre>
<div class="block">Appends a single suggestion and its weight to the internal buffers.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>utf8</code> - The suggestion (utf8 representation) to be added. The content is
          copied and the object can be reused.</dd>
<dd><code>bucket</code> - The bucket to place this suggestion in. Must be non-negative and
          smaller than the number of buckets passed in the constructor.
          Higher numbers indicate suggestions that should be presented
          before suggestions placed in smaller buckets.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></code></dd>
</dl>
</li>
</ul>
<a id="build()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>build</h4>
<pre class="methodSignature">public&nbsp;<a href="FSTCompletion.html" title="class in org.apache.lucene.search.suggest.fst">FSTCompletion</a>&nbsp;build()
                    throws <a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></pre>
<div class="block">Builds the final automaton from a list of added entries. This method may
 take a longer while as it needs to build the automaton.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></code></dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
<p class="legalCopy"><small>Copyright &copy; 2010 - 2021 Adobe. All Rights Reserved</small></p>
</footer>
</body>
</html>
