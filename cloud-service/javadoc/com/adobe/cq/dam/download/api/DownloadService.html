<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (11.0.13) on Fri Dec 17 07:25:51 UTC 2021 -->
<title>DownloadService (The Adobe Experience Manager SDK 2021.11.6058.20211123T163652Z-211100)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2021-12-17">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="DownloadService (The Adobe Experience Manager SDK 2021.11.6058.20211123T163652Z-211100)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":6,"i1":6,"i2":6,"i3":6};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">com.adobe.cq.dam.download.api</a></div>
<h2 title="Interface DownloadService" class="title">Interface DownloadService</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<pre><a href="../../../../../../org/osgi/annotation/versioning/ProviderType.html" title="annotation in org.osgi.annotation.versioning">@ProviderType</a>
public interface <span class="typeNameLabel">DownloadService</span></pre>
<div class="block"><p>
 A service that allows consumers to specify a list of targets, which will be translated
 into one or more URIs that the consumer can then use to download binaries representing
 the requested targets.
 </p>
 <p>
 The service works asynchronously, which means that the consumer will need to check with
 the service to see if the URIs are available yet. The initial request to generate the
 URIs will return immediately with an identifer that can be used to check the current
 status of the URI creation process.
 </p>

 <h2>Usage</h2>

 <p>A basic algorithm for using the service may be as follows:</p>

 <ul>
   <li>Build a list of targets for which the service should provide URIs.</li>
   <li>Request the targets from the service and remember the download ID.</li>
   <li>Use the provided download ID to poll the service until the operation is complete.</li>
   <li>If successful, use the provided URIs to retrieve the requested binaries.</li>
   <li>If unsuccessful, handle the failures accordingly.</li>
 </ul>

 <h2>Example</h2>

 <p>Sample code for consuming the service may resemble the following.</p>

 <pre>
 &#64;Component
 public class MyDownloader {

   &#64;Reference
   private DownloadService downloadService;
 
   &#64;Reference
   private DownloadApiFactory apiFactory;

   public void getDownloads(ResourceResolver resolver) throws DownloadException {
     // add target parameters needed for an asset. See DownloadTargetProcessor
     // documentation for additional details.
     Map&lt;String, Object&gt; assetParameters = new HashMap&lt;String, Object&gt;();
     assetParameters.put("path", "/content/dam/myasset.jpg");

     // create a manifest for specifying the targets to download
     DownloadManifest manifest = apiFactory.createDownloadManifest();

     // add one or more targets to the manifest. in this case we're downloading a single asset
     manifest.addTarget(apiFactory.createDownloadTarget("asset", new ValueMapDecorator(assetParameters)));

     // request the download and remember the ID
     String downloadId = downloadService.download(manifest, resolver);

     // NOTE: this construct is for example purposes only, and should not be used as-is.
     // instead, utilize a non-blocking polling mechanism
     boolean finished = false;
     while (!finished) {
       // please don't do this :)
       sleep(5000);

       // retrieve the current status of the download
       DownloadProgress progress = downloadService.getProgress(downloadId, resolver);

       // note that DownloadProgress can be used to retrieve various pieces of information
       // about the operation, including the number of items being included and the
       // current percent complete
       if (progress.isComplete()) {
         // the process has finished
         finished = true;

         // retrieve successfully generated URIs
         for (DownloadArtifact artifact : progress.getArtifacts()) {
           if (artifact.getBinaryURI() != null) {
               // execute code to request the URI and process its binary data
               doSomethingWithURI(artifact.getBinaryURI());
           } else {
               handleFailure(artifact.getFailureReason());
           }
         }
       }
     }
   }
 }
 </pre>

 <h2>Customization</h2>

 <p>
 The service provides the ability to register additional <a href="../spi/DownloadTargetProcessor.html" title="interface in com.adobe.cq.dam.download.spi"><code>DownloadTargetProcessor</code></a>
 implementations that can handle custom <a href="DownloadTarget.html" title="interface in com.adobe.cq.dam.download.api"><code>DownloadTarget</code></a> types. The process is as simple
 as providing a new OSGI Component that implements the processor interface.
 </p>

 <h2>Customization Example</h2>

 <p>
 The following is a simplified illustration of how a new <a href="../spi/DownloadTargetProcessor.html" title="interface in com.adobe.cq.dam.download.spi"><code>DownloadTargetProcessor</code></a>
 might work.
 </p>

 <pre>
 &#64;Component
 public class MyCustomTargetProcessor implements DownloadTargetProcessor {
 
   &#64;Reference
   private DownloadApiFactory apiFactory;

   &#64;Override
   public Collection&lt;DownloadFile&gt; processTarget(DownloadTarget target, ResourceResolver resolver) throws DownloadException {
     // use target's parameters. these parameters can be whatever your processor needs.
     int assetSize = target.get("assetSize", Integer.class); // in bytes
     String archivePath = target.get("archivePath", String.class);

     // note that the URL should be externally accessible, and should provide
     // the binary for the target asset. downstream entities will use this  URL
     // to bundle the asset into the final list of URLs that will be returned
     // by the DownloadService.
     String assetURL = target.get("assetURL", String.class);
 
     HashMap&lt;String, Object&gt; fileParams = new HashMap&lt;&gt;();
     fileParams.put("archivePath", archivePath);

     // create a new archive file
     DownloadFile file = apiFactory.createDownloadFile(Optional.of(assetSize), new URI(assetURL), fileParams);

     // provide one or more files that are the result of the processing
     List&lt;DownloadFile&gt; files = new ArrayList&lt;DownloadFile&gt;();
     files.add(file);

     return files;
   }

   &#64;Override
   public String getType() {
     // this indicates that DownloadTarget instances with this type should
     // be passed to this processor.
     return "myCustomType";
   }
 }
 </pre>

 <p>
 The result of the above implementation is that <a href="DownloadTarget.html" title="interface in com.adobe.cq.dam.download.api"><code>DownloadTarget</code></a> instances with the type
 of "myCustomType" will be routed to this processor implementation.
 </p></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="DownloadManifest.html" title="interface in com.adobe.cq.dam.download.api"><code>DownloadManifest</code></a>, 
<a href="DownloadTarget.html" title="interface in com.adobe.cq.dam.download.api"><code>DownloadTarget</code></a>, 
<a href="DownloadException.html" title="class in com.adobe.cq.dam.download.api"><code>DownloadException</code></a>, 
<a href="../spi/DownloadTargetProcessor.html" title="interface in com.adobe.cq.dam.download.spi"><code>DownloadTargetProcessor</code></a>, 
<a href="DownloadProgress.html" title="interface in com.adobe.cq.dam.download.api"><code>DownloadProgress</code></a></dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#download(com.adobe.cq.dam.download.api.DownloadManifest,org.apache.sling.api.resource.ResourceResolver)">download</a></span>&#8203;(<a href="DownloadManifest.html" title="interface in com.adobe.cq.dam.download.api">DownloadManifest</a>&nbsp;download,
        <a href="../../../../../../org/apache/sling/api/resource/ResourceResolver.html" title="interface in org.apache.sling.api.resource">ResourceResolver</a>&nbsp;resourceResolver)</code></th>
<td class="colLast">
<div class="block">
 Initiates the process of generating a list of URIs for retrieving the binaries of
 a requested set of targets.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html?is-external=true" title="class or interface in java.lang" class="externalLink">Iterable</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getDownloadIds(org.apache.sling.api.resource.ResourceResolver)">getDownloadIds</a></span>&#8203;(<a href="../../../../../../org/apache/sling/api/resource/ResourceResolver.html" title="interface in org.apache.sling.api.resource">ResourceResolver</a>&nbsp;resourceResolver)</code></th>
<td class="colLast">
<div class="block">
 Retrieves the ids of all downloads accessible by the current user, and which he can request the Progress of.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html?is-external=true" title="class or interface in java.lang" class="externalLink">Iterable</a>&lt;<a href="../spi/DownloadTargetProcessor.html" title="interface in com.adobe.cq.dam.download.spi">DownloadTargetProcessor</a>&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getDownloadTargetProcessors()">getDownloadTargetProcessors</a></span>()</code></th>
<td class="colLast">
<div class="block">
 Retrieves the currently available DownloadTargetProcessors.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code><a href="DownloadProgress.html" title="interface in com.adobe.cq.dam.download.api">DownloadProgress</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getProgress(java.lang.String,org.apache.sling.api.resource.ResourceResolver)">getProgress</a></span>&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;downloadId,
           <a href="../../../../../../org/apache/sling/api/resource/ResourceResolver.html" title="interface in org.apache.sling.api.resource">ResourceResolver</a>&nbsp;resourceResolver)</code></th>
<td class="colLast">
<div class="block">
 Retrieves the current progress of a requested download creation process.</div>
</td>
</tr>
</table>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="download(com.adobe.cq.dam.download.api.DownloadManifest,org.apache.sling.api.resource.ResourceResolver)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>download</h4>
<pre class="methodSignature"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;download&#8203;(<a href="DownloadManifest.html" title="interface in com.adobe.cq.dam.download.api">DownloadManifest</a>&nbsp;download,
                <a href="../../../../../../org/apache/sling/api/resource/ResourceResolver.html" title="interface in org.apache.sling.api.resource">ResourceResolver</a>&nbsp;resourceResolver)
         throws <a href="DownloadException.html" title="class in com.adobe.cq.dam.download.api">DownloadException</a></pre>
<div class="block"><p>
 Initiates the process of generating a list of URIs for retrieving the binaries of
 a requested set of targets.
 </p>
 <p>
 The operation is asynchronous, so this method will return an identifier that should be used
 to request the status of the operation. See <a href="#getProgress(java.lang.String,org.apache.sling.api.resource.ResourceResolver)"><code>getProgress(String, ResourceResolver)</code></a>.
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>download</code> - Specifies which targets should be included in the download. Target types may vary
  and are customizable, but some standard types include folders, assets, or renditions.</dd>
<dd><code>resourceResolver</code> - Will be used by the service to retrieve Resource information that may be
  required to determine which binaries to include in the download.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>An identifier for checking the status of the operation.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="DownloadException.html" title="class in com.adobe.cq.dam.download.api">DownloadException</a></code> - Will be thrown if there are failures while trying to initiate the operation.
  Note that failures encountered during the operation will be reported as part of the status.</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="DownloadManifest.html" title="interface in com.adobe.cq.dam.download.api"><code>DownloadManifest</code></a>, 
<a href="DownloadException.html" title="class in com.adobe.cq.dam.download.api"><code>DownloadException</code></a>, 
<a href="../../../../../../org/apache/sling/api/resource/ResourceResolver.html" title="interface in org.apache.sling.api.resource"><code>ResourceResolver</code></a></dd>
</dl>
</li>
</ul>
<a id="getProgress(java.lang.String,org.apache.sling.api.resource.ResourceResolver)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getProgress</h4>
<pre class="methodSignature"><a href="DownloadProgress.html" title="interface in com.adobe.cq.dam.download.api">DownloadProgress</a>&nbsp;getProgress&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;downloadId,
                             <a href="../../../../../../org/apache/sling/api/resource/ResourceResolver.html" title="interface in org.apache.sling.api.resource">ResourceResolver</a>&nbsp;resourceResolver)
                      throws <a href="DownloadException.html" title="class in com.adobe.cq.dam.download.api">DownloadException</a></pre>
<div class="block"><p>
 Retrieves the current progress of a requested download creation process.
 </p>
 <p>
 In general, the download operation has 3 major states:
 </p>
 <ul>
   <li>The operation is in-progress, and the artifacts are still being generated.</li>
   <li>The process finished successfully, and the artifacts are ready.</li>
   <li>The request failed, and error information is available.</li>
 </ul>
 <p>
 Use this method to determine the current state of a download request.
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>downloadId</code> - The ID of the download to check. This value is provided by the <a href="#download(com.adobe.cq.dam.download.api.DownloadManifest,org.apache.sling.api.resource.ResourceResolver)"><code>download(DownloadManifest, ResourceResolver)</code></a>
  method.</dd>
<dd><code>resourceResolver</code> - Will be used to authorize the user and look up status information.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current progress of the download request. Use this to check if the download is complete,
  retrieve percent complete, get failure information, or retrieve the download URIs.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="DownloadException.html" title="class in com.adobe.cq.dam.download.api">DownloadException</a></code> - Thrown if the ID doesn't exist or if there are issues retrieving status information.</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="DownloadProgress.html" title="interface in com.adobe.cq.dam.download.api"><code>DownloadProgress</code></a>, 
<a href="DownloadException.html" title="class in com.adobe.cq.dam.download.api"><code>DownloadException</code></a></dd>
</dl>
</li>
</ul>
<a id="getDownloadIds(org.apache.sling.api.resource.ResourceResolver)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDownloadIds</h4>
<pre class="methodSignature"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html?is-external=true" title="class or interface in java.lang" class="externalLink">Iterable</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&gt;&nbsp;getDownloadIds&#8203;(<a href="../../../../../../org/apache/sling/api/resource/ResourceResolver.html" title="interface in org.apache.sling.api.resource">ResourceResolver</a>&nbsp;resourceResolver)
                         throws <a href="DownloadException.html" title="class in com.adobe.cq.dam.download.api">DownloadException</a></pre>
<div class="block"><p>
 Retrieves the ids of all downloads accessible by the current user, and which he can request the Progress of.
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>resourceResolver</code> - the user's resource resolver</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the String download ids which the user has access to.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="DownloadException.html" title="class in com.adobe.cq.dam.download.api">DownloadException</a></code> - Thrown if there are issues retrieving the IDs.</dd>
</dl>
</li>
</ul>
<a id="getDownloadTargetProcessors()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getDownloadTargetProcessors</h4>
<pre class="methodSignature"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html?is-external=true" title="class or interface in java.lang" class="externalLink">Iterable</a>&lt;<a href="../spi/DownloadTargetProcessor.html" title="interface in com.adobe.cq.dam.download.spi">DownloadTargetProcessor</a>&gt;&nbsp;getDownloadTargetProcessors()</pre>
<div class="block"><p>
 Retrieves the currently available DownloadTargetProcessors.
 </p></div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the available DownloadTargetProcessors.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
<p class="legalCopy"><small>Copyright &copy; 2010 - 2021 Adobe. All Rights Reserved</small></p>
</footer>
</body>
</html>
