<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (11.0.14) on Wed Dec 06 14:36:20 UTC 2023 -->
<title>MemoryUtil (The Adobe Experience Manager SDK 2023.12.14538.20231205T165334Z-231100)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2023-12-06">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="MemoryUtil (The Adobe Experience Manager SDK 2023.12.14538.20231205T165334Z-231100)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":9,"i1":9,"i2":9,"i3":9,"i4":9,"i5":9};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">com.day.cq.dam.commons.util</a></div>
<h2 title="Class MemoryUtil" class="title">Class MemoryUtil</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>com.day.cq.dam.commons.util.MemoryUtil</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<pre>public class <span class="typeNameLabel">MemoryUtil</span>
extends java.lang.Object</pre>
<div class="block">This class offers some useful memory management functions for asset/image processing</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="MemoryUtil.Callback.html" title="interface in com.day.cq.dam.commons.util">MemoryUtil.Callback</a>&lt;<a href="MemoryUtil.Callback.html" title="type parameter in MemoryUtil.Callback">T</a>&gt;</span></code></th>
<td class="colLast">
<div class="block">Callback throwing IOException and returning some (image) object
 for <a href="#tryUntilEnoughMemory(com.day.cq.dam.api.Asset,int,com.day.cq.dam.commons.util.MemoryUtil.Callback)"><code>tryUntilEnoughMemory(com.day.cq.dam.api.Asset, int, com.day.cq.dam.commons.util.MemoryUtil.Callback)</code></a></div>
</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- =========== FIELD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Field</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#MIN_CQ_MEMORY_REQUIREMENT">MIN_CQ_MEMORY_REQUIREMENT</a></span></code></th>
<td class="colLast">
<div class="block">We assume about 100 megs as minimal cq requirement...</div>
</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E()">MemoryUtil</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ========== METHOD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>static long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getExpectedImageMemory(com.day.cq.dam.api.Asset)">getExpectedImageMemory</a></span>&#8203;(<a href="../../api/Asset.html" title="interface in com.day.cq.dam.api">Asset</a>&nbsp;asset)</code></th>
<td class="colLast">
<div class="block">Calculates the expected image memory consumption.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>static boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#hasEnoughMemory(com.day.cq.dam.api.Asset)">hasEnoughMemory</a></span>&#8203;(<a href="../../api/Asset.html" title="interface in com.day.cq.dam.api">Asset</a>&nbsp;asset)</code></th>
<td class="colLast">
<div class="block">Checks if enough memory is available for the asset/image processing
 Note: it works for images only!</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>static boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#hasEnoughSystemMemory(com.day.cq.dam.api.Asset)">hasEnoughSystemMemory</a></span>&#8203;(<a href="../../api/Asset.html" title="interface in com.day.cq.dam.api">Asset</a>&nbsp;asset)</code></th>
<td class="colLast">
<div class="block">Checks if the available max.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>static long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#suggestMaxHeapSize(com.day.cq.dam.api.Asset)">suggestMaxHeapSize</a></span>&#8203;(<a href="../../api/Asset.html" title="interface in com.day.cq.dam.api">Asset</a>&nbsp;asset)</code></th>
<td class="colLast">
<div class="block">Suggests the minimal max.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>static &lt;T&gt;&nbsp;T</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#tryUntilEnoughMemory(com.day.cq.dam.api.Asset,int,com.day.cq.dam.commons.util.MemoryUtil.Callback)">tryUntilEnoughMemory</a></span>&#8203;(<a href="../../api/Asset.html" title="interface in com.day.cq.dam.api">Asset</a>&nbsp;asset,
                    int&nbsp;maxTrials,
                    <a href="MemoryUtil.Callback.html" title="interface in com.day.cq.dam.commons.util">MemoryUtil.Callback</a>&lt;T&gt;&nbsp;callback)</code></th>
<td class="colLast">
<div class="block">Tries to execute the callback until no memory exception occurs anymore.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>static &lt;T&gt;&nbsp;T</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#tryUntilEnoughMemory(com.day.cq.dam.api.Asset,com.day.cq.dam.commons.util.MemoryUtil.Callback)">tryUntilEnoughMemory</a></span>&#8203;(<a href="../../api/Asset.html" title="interface in com.day.cq.dam.api">Asset</a>&nbsp;asset,
                    <a href="MemoryUtil.Callback.html" title="interface in com.day.cq.dam.commons.util">MemoryUtil.Callback</a>&lt;T&gt;&nbsp;callback)</code></th>
<td class="colLast">
<div class="block">Tries to execute the callback until no memory exception occurs anymore.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>equals, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a id="MIN_CQ_MEMORY_REQUIREMENT">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>MIN_CQ_MEMORY_REQUIREMENT</h4>
<pre>public static&nbsp;long MIN_CQ_MEMORY_REQUIREMENT</pre>
<div class="block">We assume about 100 megs as minimal cq requirement...</div>
</li>
</ul>
</li>
</ul>
</section>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a id="&lt;init&gt;()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>MemoryUtil</h4>
<pre>public&nbsp;MemoryUtil()</pre>
</li>
</ul>
</li>
</ul>
</section>
<!-- ============ METHOD DETAIL ========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="tryUntilEnoughMemory(com.day.cq.dam.api.Asset,com.day.cq.dam.commons.util.MemoryUtil.Callback)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>tryUntilEnoughMemory</h4>
<pre class="methodSignature">public static&nbsp;&lt;T&gt;&nbsp;T&nbsp;tryUntilEnoughMemory&#8203;(<a href="../../api/Asset.html" title="interface in com.day.cq.dam.api">Asset</a>&nbsp;asset,
                                         <a href="MemoryUtil.Callback.html" title="interface in com.day.cq.dam.commons.util">MemoryUtil.Callback</a>&lt;T&gt;&nbsp;callback)</pre>
<div class="block">Tries to execute the callback until no memory exception occurs anymore. Will first check
 if the asset can be loaded with the given JVM memory settings at all, then go into a
 loop catching "not enough memory" exceptions and retry until loading worked or a maximum
 number of retries is reached (100). If it fails, <code>null</code> will be returned.</div>
<dl>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>T</code> - return type (image object etc.)</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>asset</code> - asset to load Java 2D image from</dd>
<dd><code>callback</code> - method that actually loads an image involving Java 2D memory,
                 return value will be passed through and returned by this method</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the value returned by the callback if successful, or <code>null</code>
         if memory limits prevented loading within a certain number of trials</dd>
</dl>
</li>
</ul>
<a id="tryUntilEnoughMemory(com.day.cq.dam.api.Asset,int,com.day.cq.dam.commons.util.MemoryUtil.Callback)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>tryUntilEnoughMemory</h4>
<pre class="methodSignature">public static&nbsp;&lt;T&gt;&nbsp;T&nbsp;tryUntilEnoughMemory&#8203;(<a href="../../api/Asset.html" title="interface in com.day.cq.dam.api">Asset</a>&nbsp;asset,
                                         int&nbsp;maxTrials,
                                         <a href="MemoryUtil.Callback.html" title="interface in com.day.cq.dam.commons.util">MemoryUtil.Callback</a>&lt;T&gt;&nbsp;callback)</pre>
<div class="block">Tries to execute the callback until no memory exception occurs anymore. Will first check
 if the asset can be loaded with the given JVM memory settings at all, then go into a
 loop catching "not enough memory" exceptions and retry until loading worked or the given
 maximum number of retries is reached. If it fails, <code>null</code> will be returned.</div>
<dl>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>T</code> - return type (image object etc.)</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>asset</code> - asset to load Java 2D image from</dd>
<dd><code>maxTrials</code> - maximum number of trials, must be &gt; 0</dd>
<dd><code>callback</code> - method that actually loads an image involving Java 2D memory,
                 return value will be passed through and returned by this method</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the value returned by the callback if successful, or <code>null</code>
         if memory limits prevented loading within a certain number of trials</dd>
</dl>
</li>
</ul>
<a id="hasEnoughSystemMemory(com.day.cq.dam.api.Asset)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>hasEnoughSystemMemory</h4>
<pre class="methodSignature">public static&nbsp;boolean&nbsp;hasEnoughSystemMemory&#8203;(<a href="../../api/Asset.html" title="interface in com.day.cq.dam.api">Asset</a>&nbsp;asset)</pre>
<div class="block">Checks if the available max. memory is enough to process the image</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>asset</code> - asset to check</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><code>true</code> either if the check succeeds or the check cannot
         be performed (no image data available e.g. the asset is not an image)
         otherwise <code>false</code></dd>
</dl>
</li>
</ul>
<a id="getExpectedImageMemory(com.day.cq.dam.api.Asset)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getExpectedImageMemory</h4>
<pre class="methodSignature">public static&nbsp;long&nbsp;getExpectedImageMemory&#8203;(<a href="../../api/Asset.html" title="interface in com.day.cq.dam.api">Asset</a>&nbsp;asset)</pre>
<div class="block">Calculates the expected image memory consumption. Bytes required by each pixel are calculated from
 metadata fields like <code>photoshop:ColorMode</code> or <code>tiff:SamplesPerPixel</code>.
 If this information can be derived from metadata then it is defaulted to 4.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>asset</code> - asset to check</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the calculated amount or <code>-1</code> in case the expected
 memory cannot be calculated</dd>
</dl>
</li>
</ul>
<a id="hasEnoughMemory(com.day.cq.dam.api.Asset)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>hasEnoughMemory</h4>
<pre class="methodSignature">public static&nbsp;boolean&nbsp;hasEnoughMemory&#8203;(<a href="../../api/Asset.html" title="interface in com.day.cq.dam.api">Asset</a>&nbsp;asset)</pre>
<div class="block">Checks if enough memory is available for the asset/image processing
 Note: it works for images only!</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>asset</code> - asset to check</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><code>true</code> either if the check succeeds or the check cannot
         be performed (no image data available e.g. the asset is not an image)
         otherwise <code>false</code></dd>
</dl>
</li>
</ul>
<a id="suggestMaxHeapSize(com.day.cq.dam.api.Asset)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>suggestMaxHeapSize</h4>
<pre class="methodSignature">public static&nbsp;long&nbsp;suggestMaxHeapSize&#8203;(<a href="../../api/Asset.html" title="interface in com.day.cq.dam.api">Asset</a>&nbsp;asset)</pre>
<div class="block">Suggests the minimal max. heap size</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>asset</code> - asset to check</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>minimal max. heap size</dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
<p class="legalCopy"><small>Copyright &copy; 2010 - 2023 Adobe. All Rights Reserved</small></p>
</footer>
</body>
</html>
